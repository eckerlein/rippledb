---
title: Adapters Overview
description: Choose the right database adapter and materializer for your use case
---

import { Cards, Card } from 'fumadocs-ui/components/card';
import { Callout } from 'fumadocs-ui/components/callout';
import { Diagram } from '@/components/diagram';

# Adapters

Converge uses adapters to integrate with different databases and ORMs. There are two types:

1. **Database Adapters (`db-*`)** — Store the change log and handle append/pull
2. **Materializers (`materialize-*`)** — Project changes into domain tables

## Decision Tree

### Which Database Adapter?

<Diagram
  height={340}
  nodes={[
    { id: 'q1', x: 140, y: 10, label: 'Are you using Drizzle ORM?' },
    { id: 'yes', relativeTo: 'q1', anchor: 'bottom', offset: { y: 30, x: -100 }, variant: 'label', label: 'Yes' },
    { id: 'no', relativeTo: 'q1', anchor: 'bottom', offset: { y: 30, x: 100 }, variant: 'label', label: 'No' },
    { id: 'drizzle', x: 20, y: 120, label: 'db-drizzle' },
    { id: 'q2', x: 240, y: 120, label: 'What database?' },
    { id: 'sqlite-label', relativeTo: 'q2', anchor: 'bottom', offset: { y: 30, x: -120 }, variant: 'label', label: 'SQLite' },
    { id: 'turso-label', relativeTo: 'q2', anchor: 'bottom', offset: { y: 30 }, variant: 'label', label: 'Turso' },
    { id: 'mem-label', relativeTo: 'q2', anchor: 'bottom', offset: { y: 30, x: 120 }, variant: 'label', label: 'In-memory' },
    { id: 'sqlite', x: 140, y: 250, label: 'db-sqlite' },
    { id: 'turso', x: 280, y: 250, label: 'db-turso' },
    { id: 'memory', x: 420, y: 250, label: 'db-memory' },
  ]}
  edges={[
    { from: 'q1', to: 'drizzle', orthogonal: true },
    { from: 'q1', to: 'q2', orthogonal: true },
    { from: 'q2', to: 'sqlite', orthogonal: true },
    { from: 'q2', to: 'turso', orthogonal: true },
    { from: 'q2', to: 'memory', orthogonal: true },
  ]}
/>

### Which Materializer?

<Diagram
  height={200}
  nodes={[
    { id: 'q', x: 140, y: 10, label: 'Using db-drizzle?' },
    { id: 'yes', relativeTo: 'q', anchor: 'bottom', offset: { y: 30, x: -80 }, variant: 'label', label: 'Yes' },
    { id: 'no', relativeTo: 'q', anchor: 'bottom', offset: { y: 30, x: 80 }, variant: 'label', label: 'No' },
    { id: 'drizzle', x: 40, y: 120, label: 'materialize-drizzle' },
    { id: 'db', x: 260, y: 120, label: 'materialize-db' },
  ]}
  edges={[
    { from: 'q', to: 'drizzle', orthogonal: true },
    { from: 'q', to: 'db', orthogonal: true },
  ]}
/>

## Quick Reference

| Adapter | Best For | Sync/Async | Notes |
|---------|----------|------------|-------|
| `db-sqlite` | Local servers, Electron, tests | Sync | Uses `better-sqlite3` |
| `db-turso` | Edge deployments, serverless | Async | Uses `@libsql/client` |
| `db-drizzle` | Existing Drizzle projects | Both | Database-agnostic |
| `db-memory` | Unit tests | Sync | No persistence |
| `materialize-db` | Raw SQL projects | Both | Works with db-sqlite, db-turso |
| `materialize-drizzle` | Drizzle projects | Both | Type-safe queries |

## Database Adapters

<Cards>
  <Card 
    title="db-sqlite" 
    description="Production-ready SQLite adapter using better-sqlite3"
    href="/docs/adapters/db-sqlite"
  />
  <Card 
    title="db-turso" 
    description="Edge-ready adapter for Turso and libSQL"
    href="/docs/adapters/db-turso"
  />
  <Card 
    title="db-drizzle" 
    description="Database-agnostic adapter using Drizzle ORM"
    href="/docs/adapters/db-drizzle"
  />
  <Card 
    title="db-memory" 
    description="In-memory adapter for testing"
    href="/docs/adapters/db-memory"
  />
</Cards>

## Materializers

<Cards>
  <Card 
    title="materialize-db" 
    description="SQL-based materializer for raw SQL projects"
    href="/docs/adapters/materialize-db"
  />
  <Card 
    title="materialize-drizzle" 
    description="Type-safe materializer using Drizzle schemas"
    href="/docs/adapters/materialize-drizzle"
  />
</Cards>

## Pairing Guide

<Callout type="info">
Not all combinations work. Here are the recommended pairings:
</Callout>

| Database Adapter | Recommended Materializer |
|------------------|--------------------------|
| `db-sqlite` | `materialize-db` |
| `db-turso` | `materialize-db` |
| `db-drizzle` | `materialize-drizzle` |
| `db-memory` | Custom or none |

### Why These Pairings?

- **db-sqlite + materialize-db**: Both use raw SQL, share the same connection
- **db-turso + materialize-db**: Both use libSQL driver
- **db-drizzle + materialize-drizzle**: Both use Drizzle's query builder, type-safe

## Atomicity

All adapters guarantee atomicity within `db.append()`:

- Changes are written to the log
- Materialization happens in the same transaction
- If anything fails, everything rolls back

<Callout type="warning">
With `db-drizzle`, set `isSync: true` for synchronous drivers like `better-sqlite3` to ensure proper transaction handling. See the [db-drizzle docs](/docs/adapters/db-drizzle#issync-flag) for details.
</Callout>

## Custom Adapters

You can implement your own adapters by following the `Db` interface:

```ts
interface Db<S extends ConvergeSchema> {
  append(stream: string, changes: Change<S>[]): Promise<{ accepted: number }>;
  pull(stream: string, cursor: number | null): Promise<{ changes: Change<S>[]; cursor: number }>;
  close(): void;
}
```

See the [Server Reference](/docs/reference/server) for the full interface definition.
